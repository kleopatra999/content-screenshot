<!DOCTYPE HTML>
<style>
* {
    width: 100%;
    height: 100%;
    border: 0;
    margin: 0;
    padding: 0;
    overflow: hidden;
}
</style>
<canvas id="canvas"></canvas>
<script>
    var img = new Image();
    img.onload = dumpPngData;
    var urlParam = getParameterByName('url');
    if (urlParam)
        img.src = unescape(urlParam);

    function dumpPngData() {
        var widthParam = getParameterByName('width');
        var heightParam = getParameterByName('height');
        var width = img.naturalWidth;
        var height = img.naturalHeight;
        var ratio = width / height;

        if (widthParam) {
            width = widthParam;
        } else if (heightParam) {
            width = heightParam * ratio;
        }

        if (heightParam) {
            height = heightParam;
        } else if (widthParam) {
            height = widthParam / ratio;
        }

        canvas.width = width;
        canvas.height = height;
        var context = canvas.getContext('2d');
        context.drawImage(img, 0, 0, width, height);
        var dataURL = canvas.toDataURL();
        var pngData = dataURL.substr(dataURL.indexOf(',') + 1);
        var SVG_PNG_START = 'SvgPngBase64Encoded->';
        var SVG_PNG_END = '<-SvgPngBase64Encoded';
        console.log(SVG_PNG_START + pngData + SVG_PNG_END);
    }

    // Snippet by jolly.exe, from http://stackoverflow.com/a/901144.
    function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
            results = regex.exec(location.search);
        return results === null ? null : decodeURIComponent(results[1].replace(/\+/g, " "));
    }
</script>